{"version":3,"sources":["index.ts"],"names":[],"mappings":";AA0FI,aA1FJ,IAAM,EAAO,IACP,EAAM,GAGZ,SAAS,IACD,IAAA,EAAS,SAAS,eAAe,UACjC,EAAM,EAAO,WAAW,MAC9B,EAAO,OAAS,EAChB,EAAO,MAAQ,EACf,EAAI,UAAY,UAChB,EAAI,SAAS,EAAG,EAAG,EAAM,GAEnB,IAAA,EAAY,IAAI,kBAAkB,EAAO,GACzC,EAAW,IAAI,kBAAkB,EAAO,GAC1C,EAAK,EAGT,OAAO,iBAAiB,UAAW,SAAC,GACpB,MAAV,EAAE,IACJ,EAAM,EAAK,GACQ,MAAV,EAAE,MACP,GACF,cAAc,GACd,EAAK,GAEL,EAAK,YAAY,WACf,EAAO,EAAW,GAClB,EAAK,EAAK,IACT,KAAK,MAAM,IAAO,OAK3B,EAAM,EAAK,GAIb,SAAS,EAAM,EAA+B,GACvC,IAAA,IAAI,EAAI,EAAG,EAAI,EAAM,IACnB,IAAA,IAAI,EAAI,EAAG,EAAI,EAAM,IACxB,EAAU,EAAI,EAAO,GAAK,KAAK,MAAM,KAAK,UAG9C,EAAK,EAAK,GAIZ,SAAS,EAAK,EAA+B,GAEtC,IADC,IAAA,EAAY,EAAI,aAAa,EAAG,EAAG,EAAM,GACtC,EAAI,EAAG,EAAI,EAAM,IACnB,IAAA,IAAI,EAAI,EAAG,EAAI,EAAM,IAAK,CACvB,IAAA,EAAkC,IAA1B,EAAU,EAAI,EAAO,GACnC,EAAU,KAAK,GAAK,EAAI,EAAO,IAAM,EACrC,EAAU,KAAK,GAAK,EAAI,EAAO,GAAK,GAAK,EACzC,EAAU,KAAK,GAAK,EAAI,EAAO,GAAK,GAAK,EAG7C,EAAI,aAAa,EAAW,EAAG,GAC/B,EAAI,UAAY,MAChB,EAAI,SAAS,qCAAsC,GAAI,IAIzD,SAAS,EAAO,EAA8B,GACvC,IAAA,IAAI,EAAI,EAAG,EAAI,EAAM,IACnB,IAAA,IAAI,EAAI,EAAG,EAAI,EAAM,IAAK,CAExB,IADD,IAAA,EAAQ,EACH,GAAK,EAAG,GAAK,EAAG,IAClB,IAAA,IAAI,GAAK,EAAG,GAAK,EAAG,IACb,IAAN,GAAiB,IAAN,IACf,GAAS,EAAU,EAAI,GAAQ,EAAI,GAAK,IAGxC,IAAA,EAAQ,EAAU,EAAI,EAAO,IAC7B,EAAQ,GAAK,EAAQ,KACvB,EAAQ,GAEI,IAAV,IACF,EAAQ,GAEV,EAAS,EAAI,EAAO,GAAK,EAGxB,IAAI,EAAI,EAAG,EAAI,EAAM,IACnB,IAAI,EAAI,EAAG,EAAI,EAAM,IACxB,EAAU,EAAI,EAAO,GAAK,EAAS,EAAI,EAAO,GAKpD","file":"src.dba09a82.js","sourceRoot":"../src","sourcesContent":["const SIZE = 800;\nconst FPS = 50;\n\n// Initializes and runs the simulation.\nfunction main() {\n  const canvas = document.getElementById('canvas') as HTMLCanvasElement;\n  const ctx = canvas.getContext('2d') as CanvasRenderingContext2D;\n  canvas.height = SIZE;\n  canvas.width = SIZE;\n  ctx.fillStyle = '#000000';\n  ctx.fillRect(0, 0, SIZE, SIZE);\n\n  const gameState = new Uint8ClampedArray(SIZE * SIZE);\n  const newState = new Uint8ClampedArray(SIZE * SIZE);\n  let id = 0;\n\n  // Keyboard controls.\n  window.addEventListener('keydown', (e: KeyboardEvent) => {\n    if (e.key === 'r') {\n      reset(ctx, gameState);\n    } else if (e.key === ' ') {\n      if (id) {\n        clearInterval(id);\n        id = 0;\n      } else {\n        id = setInterval(() => {\n          update(gameState, newState);\n          draw(ctx, gameState);\n        }, Math.floor(1000 / FPS));\n      }\n    }\n  });\n\n  reset(ctx, gameState);\n}\n\n// Reset the game state.\nfunction reset(ctx: CanvasRenderingContext2D, gameState: Uint8ClampedArray) {\n  for (let i = 0; i < SIZE; i++) {\n    for (let j = 0; j < SIZE; j++) {\n      gameState[j + SIZE * i] = Math.round(Math.random());\n    }\n  }\n  draw(ctx, gameState);\n}\n\n// Draws the game state.\nfunction draw(ctx: CanvasRenderingContext2D, gameState: Uint8ClampedArray) {\n  const imageData = ctx.getImageData(0, 0, SIZE, SIZE);\n  for (let i = 0; i < SIZE; i++) {\n    for (let j = 0; j < SIZE; j++) {\n      const state = gameState[j + SIZE * i] * 255;\n      imageData.data[4 * (j + SIZE * i)] = state;\n      imageData.data[4 * (j + SIZE * i) + 1] = state;\n      imageData.data[4 * (j + SIZE * i) + 2] = state;\n    }\n  }\n  ctx.putImageData(imageData, 0, 0);\n  ctx.fillStyle = 'red';\n  ctx.fillText('spacebar to play/pause. r to reset', 10, 10);\n}\n\n// Updates the game state.\nfunction update(gameState: Uint8ClampedArray, newState: Uint8ClampedArray) {\n  for (let i = 0; i < SIZE; i++) {\n    for (let j = 0; j < SIZE; j++) {\n      let count = 0;\n      for (let k = -1; k <= 1; k++) {\n        for (let l = -1; l <= 1; l++) {\n          if (k === 0 && l === 0) continue;\n          count += gameState[j + SIZE * (i + k) + l];\n        }\n      }\n      let state = gameState[j + SIZE * i];\n      if (count > 3 || count < 2) {\n        state = 0;\n      }\n      if (count === 3) {\n        state = 1;\n      }\n      newState[j + SIZE * i] = state;\n    }\n  }\n  for (let i = 0; i < SIZE; i++) {\n    for (let j = 0; j < SIZE; j++) {\n      gameState[j + SIZE * i] = newState[j + SIZE * i];\n    }\n  }\n}\n\nmain();\n"]}